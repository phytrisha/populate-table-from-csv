<style>
  .formButton {
    display: flex;
    width: 100%;
    margin-top: 0.75rem;
    padding: 0.375rem 0.75rem;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    border-radius: 0.25rem;
    border-width: 0rem;
    background: #0D99FF;
    color: #FFF;
    text-align: center;
    font-family: Inter;
    font-size: 0.6875rem;
    font-style: normal;
    font-weight: 600;
    line-height: 1.25rem; /* 181.818% */
    cursor: pointer;
  }

  button.formButton:hover {
    background: #189fff;
  }

  button.formButton:active {
    background: #0972bd;
  }

  .radio-group {
    display: flex;
    border-radius: 4px;
    overflow: hidden;
    width: 100%;
  }

  .radio-group input[type="radio"] {
    display: none;
  }

  .radio-group label {
    padding: 7px 16px;
    font-family: Inter;
    font-size: 0.6875rem;
    font-style: normal;
    font-weight: 600;
    line-height: 1rem; /* 181.818% */
    cursor: pointer;
    border: 1px solid #0D99FF;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    text-align: center;
  }

  .radio-group label:first-of-type {
    border-top-left-radius: 4px;
    border-bottom-left-radius: 4px;
    border-right: none;
  }

  .radio-group label:last-of-type {
    border-top-right-radius: 4px;
    border-bottom-right-radius: 4px;
  }

  .radio-group input[type="radio"]:checked + label {
    background-color: #0D99FF;
    color: #FFF;
    border-color: #0D99FF;
  }

  .radio-group input[type="radio"]:not(:checked) + label {
    background-color: white;
    color: #0D99FF;
  }

  /* Optional: Add an icon to each label */
  .radio-group label::before {
    content: '';
    display: inline-block;
    width: 16px;
    height: 16px;
    margin-right: 8px;
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
  }

  #columns + label::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%230D99FF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18'/%3E%3C/svg%3E");
  }

  #rows + label::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%230D99FF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='3' width='18' height='18' rx='2' ry='2'/%3E%3Cline x1='3' y1='9' x2='21' y2='9'/%3E%3Cline x1='3' y1='15' x2='21' y2='15'/%3E%3C/svg%3E");
  }

  /* Add white versions for checked state */
  input[type="radio"]#columns:checked + label::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18'/%3E%3C/svg%3E");
  }

  input[type="radio"]#rows:checked + label::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='3' width='18' height='18' rx='2' ry='2'/%3E%3Cline x1='3' y1='9' x2='21' y2='9'/%3E%3Cline x1='3' y1='15' x2='21' y2='15'/%3E%3C/svg%3E");
  }

  #csvForm {
    max-width: 400px;
    border-radius: 0.25rem;
    border: 1px solid #E6E6E6;
    background: #FFF;
    text-align: center;
    position: relative;
    height: 5rem;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }

  #filename {
    display: block;
    color: #000;
    text-align: center;
    font-family: Inter;
    font-size: 0.6875rem;
    font-style: normal;
    font-weight: 600;
    line-height: 1.25rem; /* 181.818% */
  }

  #csvForm::after {
    content: "Click to upload .csv";
    display: block;
    color: #7F7F7F;
    text-align: center;
    font-family: Inter;
    font-size: 0.6875rem;
    font-style: normal;
    font-weight: 400;
    line-height: 1.25rem; /* 181.818% */
  }

  #csvInput {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
  }

  #csvForm:hover {
    border-color: #D1D5DB;
  }
</style>

<form id="csvForm">
  <div id="filename"></div>
  <input type="file" id="csvInput" accept=".csv" />
</form>

<form class="radio-group">
  <input type="radio" id="columns" name="layout" value="columns" checked>
  <label for="columns">Columns</label>
  <input type="radio" id="rows" name="layout" value="rows">
  <label for="rows">Rows</label>
</form>

<button type="button" class="formButton" id="submit">
  Populate
</button>

<script>

  document.getElementById('csvInput').addEventListener('change', function(e) {
    const filename = e.target.files[0] ? e.target.files[0].name : '';
    document.getElementById('filename').textContent = filename;
  });

  const form = document.querySelector("#csvForm");
  const csvFileInput = document.querySelector("#csvInput");

  const columns = document.querySelector("#columns");
  const rows = document.querySelector("#rows");

  document.getElementById('submit').addEventListener("click", function (e) {
    e.preventDefault();
    console.log("clicked on button")
    const file = csvFileInput.files[0];
    const reader = new FileReader();

    let output = "";

    reader.onload = function (e) {
      
      if (columns.checked) {
        const lines = e.target.result.split(/(?:\r\n|\r|\n)/g)
        let elements = []

        for (let i = 0; i < lines.length; i++) {
          const element = lines[i].split(",");
          elements.push(element)
        }

        for (let i = 0; i < elements[0].length; i++) {
          for (let j = 0; j < elements.length; j++) {
            output += elements[j][i] + ","
          }
        }
      } else if (rows.checked) {
        output = e.target.result.replace(/(?:\r\n|\r|\n)/g, ",");
      }

      const csvArray = output.split(",");
      
      parent.postMessage({ pluginMessage: { csvArray: csvArray } }, '*');
    };

    reader.readAsText(file);  
  });

</script>